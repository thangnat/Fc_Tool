/*
	select * from fnc_SubGroupMaster_RSP('PPD','full')
*/
Alter function fnc_SubGroupMaster_RSP
(
	@Division		nvarchar(3),
	@Type			nvarchar(4)
)
--returns TABLE
returns @tablefinal table
(
	[STT]					INT default 0,
	[Division]				nvarchar(3) null,
	[FM_KEY]				nvarchar(6) null,
	[Sales Org]				nvarchar(4) null,	
	[SUB GROUP/ Brand]		nvarchar(500) null,
	--//lAST YEAR - 2---------------------------------------
	[Y-2 (u) M1]			Numeric(18,0) default 0,
	[Y-2 (u) M2]			Numeric(18,0) default 0,
	[Y-2 (u) M3]			Numeric(18,0) default 0,
	[Y-2 (u) M4]			Numeric(18,0) default 0,
	[Y-2 (u) M5]			Numeric(18,0) default 0,
	[Y-2 (u) M6]			Numeric(18,0) default 0,
	[Y-2 (u) M7]			Numeric(18,0) default 0,
	[Y-2 (u) M8]			Numeric(18,0) default 0,
	[Y-2 (u) M9]			Numeric(18,0) default 0,
	[Y-2 (u) M10]			Numeric(18,0) default 0,
	[Y-2 (u) M11]			Numeric(18,0) default 0,
	[Y-2 (u) M12]			Numeric(18,0) default 0,
	--//LAST YEAR - 1---------------------------------------
	[Y-1 (u) M1]			Numeric(18,0) default 0,
	[Y-1 (u) M2]			Numeric(18,0) default 0,
	[Y-1 (u) M3]			Numeric(18,0) default 0,
	[Y-1 (u) M4]			Numeric(18,0) default 0,
	[Y-1 (u) M5]			Numeric(18,0) default 0,
	[Y-1 (u) M6]			Numeric(18,0) default 0,
	[Y-1 (u) M7]			Numeric(18,0) default 0,
	[Y-1 (u) M8]			Numeric(18,0) default 0,
	[Y-1 (u) M9]			Numeric(18,0) default 0,
	[Y-1 (u) M10]			Numeric(18,0) default 0,
	[Y-1 (u) M11]			Numeric(18,0) default 0,
	[Y-1 (u) M12]			Numeric(18,0) default 0,
	--/-------------------------------
	[Y0 (u) M1]				Numeric(18,0) default 0,
	[Y0 (u) M2]				Numeric(18,0) default 0,
	[Y0 (u) M3]				Numeric(18,0) default 0,
	[Y0 (u) M4]				Numeric(18,0) default 0,
	[Y0 (u) M5]				Numeric(18,0) default 0,
	[Y0 (u) M6]				Numeric(18,0) default 0,
	[Y0 (u) M7]				Numeric(18,0) default 0,
	[Y0 (u) M8]				Numeric(18,0) default 0,
	[Y0 (u) M9]				Numeric(18,0) default 0,
	[Y0 (u) M10]			Numeric(18,0) default 0,
	[Y0 (u) M11]			Numeric(18,0) default 0,
	[Y0 (u) M12]			Numeric(18,0) default 0,
	--//-----------------------------------
	[Y+1 (u) M1]			Numeric(18,0) default 0,
	[Y+1 (u) M2]			Numeric(18,0) default 0,
	[Y+1 (u) M3]			Numeric(18,0) default 0,
	[Y+1 (u) M4]			Numeric(18,0) default 0,
	[Y+1 (u) M5]			Numeric(18,0) default 0,
	[Y+1 (u) M6]			Numeric(18,0) default 0,
	[Y+1 (u) M7]			Numeric(18,0) default 0,
	[Y+1 (u) M8]			Numeric(18,0) default 0,
	[Y+1 (u) M9]			Numeric(18,0) default 0,
	[Y+1 (u) M10]			Numeric(18,0) default 0,
	[Y+1 (u) M11]			Numeric(18,0) default 0,
	[Y+1 (u) M12]			Numeric(18,0) default 0,
	--//budget Y0-----------------------------------
	[B_Y0_M1]				Numeric(18,0) default 0,
	[B_Y0_M2]				Numeric(18,0) default 0,
	[B_Y0_M3]				Numeric(18,0) default 0,
	[B_Y0_M4]				Numeric(18,0) default 0,
	[B_Y0_M5]				Numeric(18,0) default 0,
	[B_Y0_M6]				Numeric(18,0) default 0,
	[B_Y0_M7]				Numeric(18,0) default 0,
	[B_Y0_M8]				Numeric(18,0) default 0,
	[B_Y0_M9]				Numeric(18,0) default 0,
	[B_Y0_M10]				Numeric(18,0) default 0,
	[B_Y0_M11]				Numeric(18,0) default 0,
	[B_Y0_M12]				Numeric(18,0) default 0,
	--//budget Y+1-----------------------------------
	[B_Y+1_M1]				Numeric(18,0) default 0,
	[B_Y+1_M2]				Numeric(18,0) default 0,
	[B_Y+1_M3]				Numeric(18,0) default 0,
	[B_Y+1_M4]				Numeric(18,0) default 0,
	[B_Y+1_M5]				Numeric(18,0) default 0,
	[B_Y+1_M6]				Numeric(18,0) default 0,
	[B_Y+1_M7]				Numeric(18,0) default 0,
	[B_Y+1_M8]				Numeric(18,0) default 0,
	[B_Y+1_M9]				Numeric(18,0) default 0,
	[B_Y+1_M10]				Numeric(18,0) default 0,
	[B_Y+1_M11]				Numeric(18,0) default 0,
	[B_Y+1_M12]				Numeric(18,0) default 0,
	--//Pre-budget Y+1-----------------------------------
	[PB_Y+1_M1]				Numeric(18,0) default 0,
	[PB_Y+1_M2]				Numeric(18,0) default 0,
	[PB_Y+1_M3]				Numeric(18,0) default 0,
	[PB_Y+1_M4]				Numeric(18,0) default 0,
	[PB_Y+1_M5]				Numeric(18,0) default 0,
	[PB_Y+1_M6]				Numeric(18,0) default 0,
	[PB_Y+1_M7]				Numeric(18,0) default 0,
	[PB_Y+1_M8]				Numeric(18,0) default 0,
	[PB_Y+1_M9]				Numeric(18,0) default 0,
	[PB_Y+1_M10]			Numeric(18,0) default 0,
	[PB_Y+1_M11]			Numeric(18,0) default 0,
	[PB_Y+1_M12]			Numeric(18,0) default 0,
	----//Tren 3 Y0-----------------------------------
	[T1_Y0_M1]				Numeric(18,0) default 0,
	[T1_Y0_M2]				Numeric(18,0) default 0,
	[T1_Y0_M3]				Numeric(18,0) default 0,
	[T1_Y0_M4]				Numeric(18,0) default 0,
	[T1_Y0_M5]				Numeric(18,0) default 0,
	[T1_Y0_M6]				Numeric(18,0) default 0,
	[T1_Y0_M7]				Numeric(18,0) default 0,
	[T1_Y0_M8]				Numeric(18,0) default 0,
	[T1_Y0_M9]				Numeric(18,0) default 0,
	[T1_Y0_M10]				Numeric(18,0) default 0,
	[T1_Y0_M11]				Numeric(18,0) default 0,
	[T1_Y0_M12]				Numeric(18,0) default 0,
	----//Tren 5 Y0-----------------------------------
	[T2_Y0_M1]				Numeric(18,0) default 0,
	[T2_Y0_M2]				Numeric(18,0) default 0,
	[T2_Y0_M3]				Numeric(18,0) default 0,
	[T2_Y0_M4]				Numeric(18,0) default 0,
	[T2_Y0_M5]				Numeric(18,0) default 0,
	[T2_Y0_M6]				Numeric(18,0) default 0,
	[T2_Y0_M7]				Numeric(18,0) default 0,
	[T2_Y0_M8]				Numeric(18,0) default 0,
	[T2_Y0_M9]				Numeric(18,0) default 0,
	[T2_Y0_M10]				Numeric(18,0) default 0,
	[T2_Y0_M11]				Numeric(18,0) default 0,
	[T2_Y0_M12]				Numeric(18,0) default 0,
	----//Tren 7 Y0-----------------------------------
	[T3_Y0_M1]				Numeric(18,0) default 0,
	[T3_Y0_M2]				Numeric(18,0) default 0,
	[T3_Y0_M3]				Numeric(18,0) default 0,
	[T3_Y0_M4]				Numeric(18,0) default 0,
	[T3_Y0_M5]				Numeric(18,0) default 0,
	[T3_Y0_M6]				Numeric(18,0) default 0,
	[T3_Y0_M7]				Numeric(18,0) default 0,
	[T3_Y0_M8]				Numeric(18,0) default 0,
	[T3_Y0_M9]				Numeric(18,0) default 0,
	[T3_Y0_M10]				Numeric(18,0) default 0,
	[T3_Y0_M11]				Numeric(18,0) default 0,
	[T3_Y0_M12]				Numeric(18,0) default 0
)
with encryption
As
begin
	declare @tableTmp table
	(
		[STT]					INT default 0,
		[Division]				nvarchar(3) null,
		[FM_KEY]				nvarchar(6) null,
		[Sales Org]				nvarchar(4) null,	
		[SUB GROUP/ Brand]		nvarchar(500) null,
		--//lAST YEAR - 2---------------------------------------
		[Y-2 (u) M1]			Numeric(18,0) default 0,
		[Y-2 (u) M2]			Numeric(18,0) default 0,
		[Y-2 (u) M3]			Numeric(18,0) default 0,
		[Y-2 (u) M4]			Numeric(18,0) default 0,
		[Y-2 (u) M5]			Numeric(18,0) default 0,
		[Y-2 (u) M6]			Numeric(18,0) default 0,
		[Y-2 (u) M7]			Numeric(18,0) default 0,
		[Y-2 (u) M8]			Numeric(18,0) default 0,
		[Y-2 (u) M9]			Numeric(18,0) default 0,
		[Y-2 (u) M10]			Numeric(18,0) default 0,
		[Y-2 (u) M11]			Numeric(18,0) default 0,
		[Y-2 (u) M12]			Numeric(18,0) default 0,
		--//LAST YEAR - 1---------------------------------------
		[Y-1 (u) M1]			Numeric(18,0) default 0,
		[Y-1 (u) M2]			Numeric(18,0) default 0,
		[Y-1 (u) M3]			Numeric(18,0) default 0,
		[Y-1 (u) M4]			Numeric(18,0) default 0,
		[Y-1 (u) M5]			Numeric(18,0) default 0,
		[Y-1 (u) M6]			Numeric(18,0) default 0,
		[Y-1 (u) M7]			Numeric(18,0) default 0,
		[Y-1 (u) M8]			Numeric(18,0) default 0,
		[Y-1 (u) M9]			Numeric(18,0) default 0,
		[Y-1 (u) M10]			Numeric(18,0) default 0,
		[Y-1 (u) M11]			Numeric(18,0) default 0,
		[Y-1 (u) M12]			Numeric(18,0) default 0,
		--/-------------------------------
		[Y0 (u) M1]				Numeric(18,0) default 0,
		[Y0 (u) M2]				Numeric(18,0) default 0,
		[Y0 (u) M3]				Numeric(18,0) default 0,
		[Y0 (u) M4]				Numeric(18,0) default 0,
		[Y0 (u) M5]				Numeric(18,0) default 0,
		[Y0 (u) M6]				Numeric(18,0) default 0,
		[Y0 (u) M7]				Numeric(18,0) default 0,
		[Y0 (u) M8]				Numeric(18,0) default 0,
		[Y0 (u) M9]				Numeric(18,0) default 0,
		[Y0 (u) M10]			Numeric(18,0) default 0,
		[Y0 (u) M11]			Numeric(18,0) default 0,
		[Y0 (u) M12]			Numeric(18,0) default 0,
		--//-----------------------------------
		[Y+1 (u) M1]			Numeric(18,0) default 0,
		[Y+1 (u) M2]			Numeric(18,0) default 0,
		[Y+1 (u) M3]			Numeric(18,0) default 0,
		[Y+1 (u) M4]			Numeric(18,0) default 0,
		[Y+1 (u) M5]			Numeric(18,0) default 0,
		[Y+1 (u) M6]			Numeric(18,0) default 0,
		[Y+1 (u) M7]			Numeric(18,0) default 0,
		[Y+1 (u) M8]			Numeric(18,0) default 0,
		[Y+1 (u) M9]			Numeric(18,0) default 0,
		[Y+1 (u) M10]			Numeric(18,0) default 0,
		[Y+1 (u) M11]			Numeric(18,0) default 0,
		[Y+1 (u) M12]			Numeric(18,0) default 0,
		--//budget Y0-----------------------------------
		[B_Y0_M1]				Numeric(18,0) default 0,
		[B_Y0_M2]				Numeric(18,0) default 0,
		[B_Y0_M3]				Numeric(18,0) default 0,
		[B_Y0_M4]				Numeric(18,0) default 0,
		[B_Y0_M5]				Numeric(18,0) default 0,
		[B_Y0_M6]				Numeric(18,0) default 0,
		[B_Y0_M7]				Numeric(18,0) default 0,
		[B_Y0_M8]				Numeric(18,0) default 0,
		[B_Y0_M9]				Numeric(18,0) default 0,
		[B_Y0_M10]				Numeric(18,0) default 0,
		[B_Y0_M11]				Numeric(18,0) default 0,
		[B_Y0_M12]				Numeric(18,0) default 0,
		--//budget Y+1-----------------------------------
		[B_Y+1_M1]				Numeric(18,0) default 0,
		[B_Y+1_M2]				Numeric(18,0) default 0,
		[B_Y+1_M3]				Numeric(18,0) default 0,
		[B_Y+1_M4]				Numeric(18,0) default 0,
		[B_Y+1_M5]				Numeric(18,0) default 0,
		[B_Y+1_M6]				Numeric(18,0) default 0,
		[B_Y+1_M7]				Numeric(18,0) default 0,
		[B_Y+1_M8]				Numeric(18,0) default 0,
		[B_Y+1_M9]				Numeric(18,0) default 0,
		[B_Y+1_M10]				Numeric(18,0) default 0,
		[B_Y+1_M11]				Numeric(18,0) default 0,
		[B_Y+1_M12]				Numeric(18,0) default 0,
		--//Pre-budget Y+1-----------------------------------
		[PB_Y+1_M1]				Numeric(18,0) default 0,
		[PB_Y+1_M2]				Numeric(18,0) default 0,
		[PB_Y+1_M3]				Numeric(18,0) default 0,
		[PB_Y+1_M4]				Numeric(18,0) default 0,
		[PB_Y+1_M5]				Numeric(18,0) default 0,
		[PB_Y+1_M6]				Numeric(18,0) default 0,
		[PB_Y+1_M7]				Numeric(18,0) default 0,
		[PB_Y+1_M8]				Numeric(18,0) default 0,
		[PB_Y+1_M9]				Numeric(18,0) default 0,
		[PB_Y+1_M10]			Numeric(18,0) default 0,
		[PB_Y+1_M11]			Numeric(18,0) default 0,
		[PB_Y+1_M12]			Numeric(18,0) default 0,
		----//Tren 3 Y0-----------------------------------
		[T1_Y0_M1]				Numeric(18,0) default 0,
		[T1_Y0_M2]				Numeric(18,0) default 0,
		[T1_Y0_M3]				Numeric(18,0) default 0,
		[T1_Y0_M4]				Numeric(18,0) default 0,
		[T1_Y0_M5]				Numeric(18,0) default 0,
		[T1_Y0_M6]				Numeric(18,0) default 0,
		[T1_Y0_M7]				Numeric(18,0) default 0,
		[T1_Y0_M8]				Numeric(18,0) default 0,
		[T1_Y0_M9]				Numeric(18,0) default 0,
		[T1_Y0_M10]				Numeric(18,0) default 0,
		[T1_Y0_M11]				Numeric(18,0) default 0,
		[T1_Y0_M12]				Numeric(18,0) default 0,
		----//Tren 5 Y0-----------------------------------
		[T2_Y0_M1]				Numeric(18,0) default 0,
		[T2_Y0_M2]				Numeric(18,0) default 0,
		[T2_Y0_M3]				Numeric(18,0) default 0,
		[T2_Y0_M4]				Numeric(18,0) default 0,
		[T2_Y0_M5]				Numeric(18,0) default 0,
		[T2_Y0_M6]				Numeric(18,0) default 0,
		[T2_Y0_M7]				Numeric(18,0) default 0,
		[T2_Y0_M8]				Numeric(18,0) default 0,
		[T2_Y0_M9]				Numeric(18,0) default 0,
		[T2_Y0_M10]				Numeric(18,0) default 0,
		[T2_Y0_M11]				Numeric(18,0) default 0,
		[T2_Y0_M12]				Numeric(18,0) default 0,
		----//Tren 7 Y0-----------------------------------
		[T3_Y0_M1]				Numeric(18,0) default 0,
		[T3_Y0_M2]				Numeric(18,0) default 0,
		[T3_Y0_M3]				Numeric(18,0) default 0,
		[T3_Y0_M4]				Numeric(18,0) default 0,
		[T3_Y0_M5]				Numeric(18,0) default 0,
		[T3_Y0_M6]				Numeric(18,0) default 0,
		[T3_Y0_M7]				Numeric(18,0) default 0,
		[T3_Y0_M8]				Numeric(18,0) default 0,
		[T3_Y0_M9]				Numeric(18,0) default 0,
		[T3_Y0_M10]				Numeric(18,0) default 0,
		[T3_Y0_M11]				Numeric(18,0) default 0,
		[T3_Y0_M12]				Numeric(18,0) default 0
	)
	if @Division='CPD'
	begin
		Insert into @tableTmp
		select
			*
		from
		(
			--//His Y-2
			select DISTINCT
				[STT] = ROW_NUMBER() OVER(PARTITION BY [Division],[Sales Org],[SUB GROUP/ Brand] ORDER BY [Y-2 (u) M1] DESC),
				[Division]=ISNULL([Division],''),
				[FM_KEY]=isnull([FM_KEY],''),
				[Sales Org]=ISNULL([Sales Org],''),
				[SUB GROUP/ Brand]=ISNULL([SUB GROUP/ Brand],''),
				[Y-2 (u) M1]=ISNULL([Y-2 (u) M1],0),
				[Y-2 (u) M2]=ISNULL([Y-2 (u) M2],0),
				[Y-2 (u) M3]=ISNULL([Y-2 (u) M3],0),
				[Y-2 (u) M4]=ISNULL([Y-2 (u) M4],0),
				[Y-2 (u) M5]=ISNULL([Y-2 (u) M5],0),
				[Y-2 (u) M6]=ISNULL([Y-2 (u) M6],0),
				[Y-2 (u) M7]=ISNULL([Y-2 (u) M7],0),
				[Y-2 (u) M8]=ISNULL([Y-2 (u) M8],0),
				[Y-2 (u) M9]=ISNULL([Y-2 (u) M9],0),
				[Y-2 (u) M10]=ISNULL([Y-2 (u) M10],0),
				[Y-2 (u) M11]=ISNULL([Y-2 (u) M11],0),
				[Y-2 (u) M12]=ISNULL([Y-2 (u) M12],0),
				--//His Y-1
				[Y-1 (u) M1]=ISNULL([Y-1 (u) M1],0),
				[Y-1 (u) M2]=ISNULL([Y-1 (u) M2],0),
				[Y-1 (u) M3]=ISNULL([Y-1 (u) M3],0),
				[Y-1 (u) M4]=ISNULL([Y-1 (u) M4],0),
				[Y-1 (u) M5]=ISNULL([Y-1 (u) M5],0),
				[Y-1 (u) M6]=ISNULL([Y-1 (u) M6],0),
				[Y-1 (u) M7]=ISNULL([Y-1 (u) M7],0),
				[Y-1 (u) M8]=ISNULL([Y-1 (u) M8],0),
				[Y-1 (u) M9]=ISNULL([Y-1 (u) M9],0),
				[Y-1 (u) M10]=ISNULL([Y-1 (u) M10],0),
				[Y-1 (u) M11]=ISNULL([Y-1 (u) M11],0),
				[Y-1 (u) M12]=ISNULL([Y-1 (u) M12],0),
				--//forecast Y0
				[Y0 (u) M1]=ISNULL([Y0 (u) M1],0),
				[Y0 (u) M2]=ISNULL([Y0 (u) M2],0),
				[Y0 (u) M3]=ISNULL([Y0 (u) M3],0),
				[Y0 (u) M4]=ISNULL([Y0 (u) M4],0),
				[Y0 (u) M5]=ISNULL([Y0 (u) M5],0),
				[Y0 (u) M6]=ISNULL([Y0 (u) M6],0),
				[Y0 (u) M7]=ISNULL([Y0 (u) M7],0),
				[Y0 (u) M8]=ISNULL([Y0 (u) M8],0),
				[Y0 (u) M9]=ISNULL([Y0 (u) M9],0),
				[Y0 (u) M10]=ISNULL([Y0 (u) M10],0),
				[Y0 (u) M11]=ISNULL([Y0 (u) M11],0),
				[Y0 (u) M12]=ISNULL([Y0 (u) M12],0),
				--//forecast Y+1
				[Y+1 (u) M1]=ISNULL([Y+1 (u) M1],0),
				[Y+1 (u) M2]=ISNULL([Y+1 (u) M2],0),
				[Y+1 (u) M3]=ISNULL([Y+1 (u) M3],0),
				[Y+1 (u) M4]=ISNULL([Y+1 (u) M4],0),
				[Y+1 (u) M5]=ISNULL([Y+1 (u) M5],0),
				[Y+1 (u) M6]=ISNULL([Y+1 (u) M6],0),
				[Y+1 (u) M7]=ISNULL([Y+1 (u) M7],0),
				[Y+1 (u) M8]=ISNULL([Y+1 (u) M8],0),
				[Y+1 (u) M9]=ISNULL([Y+1 (u) M9],0),
				[Y+1 (u) M10]=ISNULL([Y+1 (u) M10],0),
				[Y+1 (u) M11]=ISNULL([Y+1 (u) M11],0),
				[Y+1 (u) M12]=ISNULL([Y+1 (u) M12],0),
				--//budget y0		
				[B_Y0_M1]=ISNULL([B_Y0_M1],0),
				[B_Y0_M2]=ISNULL([B_Y0_M2],0),
				[B_Y0_M3]=ISNULL([B_Y0_M3],0),
				[B_Y0_M4]=ISNULL([B_Y0_M4],0),
				[B_Y0_M5]=ISNULL([B_Y0_M5],0),
				[B_Y0_M6]=ISNULL([B_Y0_M6],0),
				[B_Y0_M7]=ISNULL([B_Y0_M7],0),
				[B_Y0_M8]=ISNULL([B_Y0_M8],0),
				[B_Y0_M9]=ISNULL([B_Y0_M9],0),
				[B_Y0_M10]=ISNULL([B_Y0_M10],0),
				[B_Y0_M11]=ISNULL([B_Y0_M11],0),
				[B_Y0_M12]=ISNULL([B_Y0_M12],0),
				--//budget Y+1
				[B_Y+1_M1]=ISNULL([B_Y+1_M1],0),
				[B_Y+1_M2]=ISNULL([B_Y+1_M2],0),
				[B_Y+1_M3]=ISNULL([B_Y+1_M3],0),
				[B_Y+1_M4]=ISNULL([B_Y+1_M4],0),
				[B_Y+1_M5]=ISNULL([B_Y+1_M5],0),
				[B_Y+1_M6]=ISNULL([B_Y+1_M6],0),
				[B_Y+1_M7]=ISNULL([B_Y+1_M7],0),
				[B_Y+1_M8]=ISNULL([B_Y+1_M8],0),
				[B_Y+1_M9]=ISNULL([B_Y+1_M9],0),
				[B_Y+1_M10]=ISNULL([B_Y+1_M10],0),
				[B_Y+1_M11]=ISNULL([B_Y+1_M11],0),
				[B_Y+1_M12]=ISNULL([B_Y+1_M12],0),
				--//pre budget Y+1
				[PB_Y+1_M1]=ISNULL([PB_Y+1_M1],0),
				[PB_Y+1_M2]=ISNULL([PB_Y+1_M2],0),
				[PB_Y+1_M3]=ISNULL([PB_Y+1_M3],0),
				[PB_Y+1_M4]=ISNULL([PB_Y+1_M4],0),
				[PB_Y+1_M5]=ISNULL([PB_Y+1_M5],0),
				[PB_Y+1_M6]=ISNULL([PB_Y+1_M6],0),
				[PB_Y+1_M7]=ISNULL([PB_Y+1_M7],0),
				[PB_Y+1_M8]=ISNULL([PB_Y+1_M8],0),
				[PB_Y+1_M9]=ISNULL([PB_Y+1_M9],0),
				[PB_Y+1_M10]=ISNULL([PB_Y+1_M10],0),
				[PB_Y+1_M11]=ISNULL([PB_Y+1_M11],0),
				[PB_Y+1_M12]=ISNULL([PB_Y+1_M12],0),
				--//Trend 1 Y0
				[T1_Y0_M1]=ISNULL([T1_Y0_M1],0),
				[T1_Y0_M2]=ISNULL([T1_Y0_M2],0),
				[T1_Y0_M3]=ISNULL([T1_Y0_M3],0),
				[T1_Y0_M4]=ISNULL([T1_Y0_M4],0),
				[T1_Y0_M5]=ISNULL([T1_Y0_M5],0),
				[T1_Y0_M6]=ISNULL([T1_Y0_M6],0),
				[T1_Y0_M7]=ISNULL([T1_Y0_M7],0),
				[T1_Y0_M8]=ISNULL([T1_Y0_M8],0),
				[T1_Y0_M9]=ISNULL([T1_Y0_M9],0),
				[T1_Y0_M10]=ISNULL([T1_Y0_M10],0),
				[T1_Y0_M11]=ISNULL([T1_Y0_M11],0),
				[T1_Y0_M12]=ISNULL([T1_Y0_M12],0),
				--//Trend 2 Y0
				[T2_Y0_M1]=ISNULL([T2_Y0_M1],0),
				[T2_Y0_M2]=ISNULL([T2_Y0_M2],0),
				[T2_Y0_M3]=ISNULL([T2_Y0_M3],0),
				[T2_Y0_M4]=ISNULL([T2_Y0_M4],0),
				[T2_Y0_M5]=ISNULL([T2_Y0_M5],0),
				[T2_Y0_M6]=ISNULL([T2_Y0_M6],0),
				[T2_Y0_M7]=ISNULL([T2_Y0_M7],0),
				[T2_Y0_M8]=ISNULL([T2_Y0_M8],0),
				[T2_Y0_M9]=ISNULL([T2_Y0_M9],0),
				[T2_Y0_M10]=ISNULL([T2_Y0_M10],0),
				[T2_Y0_M11]=ISNULL([T2_Y0_M11],0),
				[T2_Y0_M12]=ISNULL([T2_Y0_M12],0),
				--//---------------------
				[T3_Y0_M1]=ISNULL([T3_Y0_M1],0),
				[T3_Y0_M2]=ISNULL([T3_Y0_M2],0),
				[T3_Y0_M3]=ISNULL([T3_Y0_M3],0),
				[T3_Y0_M4]=ISNULL([T3_Y0_M4],0),
				[T3_Y0_M5]=ISNULL([T3_Y0_M5],0),
				[T3_Y0_M6]=ISNULL([T3_Y0_M6],0),
				[T3_Y0_M7]=ISNULL([T3_Y0_M7],0),
				[T3_Y0_M8]=ISNULL([T3_Y0_M8],0),
				[T3_Y0_M9]=ISNULL([T3_Y0_M9],0),
				[T3_Y0_M10]=ISNULL([T3_Y0_M10],0),
				[T3_Y0_M11]=ISNULL([T3_Y0_M11],0),
				[T3_Y0_M12]=ISNULL([T3_Y0_M12],0)
			from fnc_SubGroupMaster_Full_CPD
			where FM_KEY=(select top 1 FM_KEY from FC_ComputerName (NOLOCK) where [ComputerName]=HOST_NAME())
			--[ComputerName]=HOST_NAME()
		) as x
		WHERE stt = 1
	end
	if @Division='LLD'
	begin
		Insert into @tableTmp
		select
			*
		from
		(
			--//His Y-2
			select DISTINCT
				[STT] = ROW_NUMBER() OVER(PARTITION BY [Division],[Sales Org],[SUB GROUP/ Brand] ORDER BY [Y-2 (u) M1] DESC),
				[Division]=ISNULL([Division],''),
				[FM_KEY]=isnull([FM_KEY],''),
				[Sales Org]=ISNULL([Sales Org],''),
				[SUB GROUP/ Brand]=ISNULL([SUB GROUP/ Brand],''),
				[Y-2 (u) M1]=ISNULL([Y-2 (u) M1],0),
				[Y-2 (u) M2]=ISNULL([Y-2 (u) M2],0),
				[Y-2 (u) M3]=ISNULL([Y-2 (u) M3],0),
				[Y-2 (u) M4]=ISNULL([Y-2 (u) M4],0),
				[Y-2 (u) M5]=ISNULL([Y-2 (u) M5],0),
				[Y-2 (u) M6]=ISNULL([Y-2 (u) M6],0),
				[Y-2 (u) M7]=ISNULL([Y-2 (u) M7],0),
				[Y-2 (u) M8]=ISNULL([Y-2 (u) M8],0),
				[Y-2 (u) M9]=ISNULL([Y-2 (u) M9],0),
				[Y-2 (u) M10]=ISNULL([Y-2 (u) M10],0),
				[Y-2 (u) M11]=ISNULL([Y-2 (u) M11],0),
				[Y-2 (u) M12]=ISNULL([Y-2 (u) M12],0),
				--//His Y-1
				[Y-1 (u) M1]=ISNULL([Y-1 (u) M1],0),
				[Y-1 (u) M2]=ISNULL([Y-1 (u) M2],0),
				[Y-1 (u) M3]=ISNULL([Y-1 (u) M3],0),
				[Y-1 (u) M4]=ISNULL([Y-1 (u) M4],0),
				[Y-1 (u) M5]=ISNULL([Y-1 (u) M5],0),
				[Y-1 (u) M6]=ISNULL([Y-1 (u) M6],0),
				[Y-1 (u) M7]=ISNULL([Y-1 (u) M7],0),
				[Y-1 (u) M8]=ISNULL([Y-1 (u) M8],0),
				[Y-1 (u) M9]=ISNULL([Y-1 (u) M9],0),
				[Y-1 (u) M10]=ISNULL([Y-1 (u) M10],0),
				[Y-1 (u) M11]=ISNULL([Y-1 (u) M11],0),
				[Y-1 (u) M12]=ISNULL([Y-1 (u) M12],0),
				--//forecast Y0
				[Y0 (u) M1]=ISNULL([Y0 (u) M1],0),
				[Y0 (u) M2]=ISNULL([Y0 (u) M2],0),
				[Y0 (u) M3]=ISNULL([Y0 (u) M3],0),
				[Y0 (u) M4]=ISNULL([Y0 (u) M4],0),
				[Y0 (u) M5]=ISNULL([Y0 (u) M5],0),
				[Y0 (u) M6]=ISNULL([Y0 (u) M6],0),
				[Y0 (u) M7]=ISNULL([Y0 (u) M7],0),
				[Y0 (u) M8]=ISNULL([Y0 (u) M8],0),
				[Y0 (u) M9]=ISNULL([Y0 (u) M9],0),
				[Y0 (u) M10]=ISNULL([Y0 (u) M10],0),
				[Y0 (u) M11]=ISNULL([Y0 (u) M11],0),
				[Y0 (u) M12]=ISNULL([Y0 (u) M12],0),
				--//forecast Y+1
				[Y+1 (u) M1]=ISNULL([Y+1 (u) M1],0),
				[Y+1 (u) M2]=ISNULL([Y+1 (u) M2],0),
				[Y+1 (u) M3]=ISNULL([Y+1 (u) M3],0),
				[Y+1 (u) M4]=ISNULL([Y+1 (u) M4],0),
				[Y+1 (u) M5]=ISNULL([Y+1 (u) M5],0),
				[Y+1 (u) M6]=ISNULL([Y+1 (u) M6],0),
				[Y+1 (u) M7]=ISNULL([Y+1 (u) M7],0),
				[Y+1 (u) M8]=ISNULL([Y+1 (u) M8],0),
				[Y+1 (u) M9]=ISNULL([Y+1 (u) M9],0),
				[Y+1 (u) M10]=ISNULL([Y+1 (u) M10],0),
				[Y+1 (u) M11]=ISNULL([Y+1 (u) M11],0),
				[Y+1 (u) M12]=ISNULL([Y+1 (u) M12],0),
				--//budget y0		
				[B_Y0_M1]=ISNULL([B_Y0_M1],0),
				[B_Y0_M2]=ISNULL([B_Y0_M2],0),
				[B_Y0_M3]=ISNULL([B_Y0_M3],0),
				[B_Y0_M4]=ISNULL([B_Y0_M4],0),
				[B_Y0_M5]=ISNULL([B_Y0_M5],0),
				[B_Y0_M6]=ISNULL([B_Y0_M6],0),
				[B_Y0_M7]=ISNULL([B_Y0_M7],0),
				[B_Y0_M8]=ISNULL([B_Y0_M8],0),
				[B_Y0_M9]=ISNULL([B_Y0_M9],0),
				[B_Y0_M10]=ISNULL([B_Y0_M10],0),
				[B_Y0_M11]=ISNULL([B_Y0_M11],0),
				[B_Y0_M12]=ISNULL([B_Y0_M12],0),
				--//budget Y+1
				[B_Y+1_M1]=ISNULL([B_Y+1_M1],0),
				[B_Y+1_M2]=ISNULL([B_Y+1_M2],0),
				[B_Y+1_M3]=ISNULL([B_Y+1_M3],0),
				[B_Y+1_M4]=ISNULL([B_Y+1_M4],0),
				[B_Y+1_M5]=ISNULL([B_Y+1_M5],0),
				[B_Y+1_M6]=ISNULL([B_Y+1_M6],0),
				[B_Y+1_M7]=ISNULL([B_Y+1_M7],0),
				[B_Y+1_M8]=ISNULL([B_Y+1_M8],0),
				[B_Y+1_M9]=ISNULL([B_Y+1_M9],0),
				[B_Y+1_M10]=ISNULL([B_Y+1_M10],0),
				[B_Y+1_M11]=ISNULL([B_Y+1_M11],0),
				[B_Y+1_M12]=ISNULL([B_Y+1_M12],0),
				--//pre budget Y+1
				[PB_Y+1_M1]=ISNULL([PB_Y+1_M1],0),
				[PB_Y+1_M2]=ISNULL([PB_Y+1_M2],0),
				[PB_Y+1_M3]=ISNULL([PB_Y+1_M3],0),
				[PB_Y+1_M4]=ISNULL([PB_Y+1_M4],0),
				[PB_Y+1_M5]=ISNULL([PB_Y+1_M5],0),
				[PB_Y+1_M6]=ISNULL([PB_Y+1_M6],0),
				[PB_Y+1_M7]=ISNULL([PB_Y+1_M7],0),
				[PB_Y+1_M8]=ISNULL([PB_Y+1_M8],0),
				[PB_Y+1_M9]=ISNULL([PB_Y+1_M9],0),
				[PB_Y+1_M10]=ISNULL([PB_Y+1_M10],0),
				[PB_Y+1_M11]=ISNULL([PB_Y+1_M11],0),
				[PB_Y+1_M12]=ISNULL([PB_Y+1_M12],0),
				--//Trend 1 Y0
				[T1_Y0_M1]=ISNULL([T1_Y0_M1],0),
				[T1_Y0_M2]=ISNULL([T1_Y0_M2],0),
				[T1_Y0_M3]=ISNULL([T1_Y0_M3],0),
				[T1_Y0_M4]=ISNULL([T1_Y0_M4],0),
				[T1_Y0_M5]=ISNULL([T1_Y0_M5],0),
				[T1_Y0_M6]=ISNULL([T1_Y0_M6],0),
				[T1_Y0_M7]=ISNULL([T1_Y0_M7],0),
				[T1_Y0_M8]=ISNULL([T1_Y0_M8],0),
				[T1_Y0_M9]=ISNULL([T1_Y0_M9],0),
				[T1_Y0_M10]=ISNULL([T1_Y0_M10],0),
				[T1_Y0_M11]=ISNULL([T1_Y0_M11],0),
				[T1_Y0_M12]=ISNULL([T1_Y0_M12],0),
				--//Trend 2 Y0
				[T2_Y0_M1]=ISNULL([T2_Y0_M1],0),
				[T2_Y0_M2]=ISNULL([T2_Y0_M2],0),
				[T2_Y0_M3]=ISNULL([T2_Y0_M3],0),
				[T2_Y0_M4]=ISNULL([T2_Y0_M4],0),
				[T2_Y0_M5]=ISNULL([T2_Y0_M5],0),
				[T2_Y0_M6]=ISNULL([T2_Y0_M6],0),
				[T2_Y0_M7]=ISNULL([T2_Y0_M7],0),
				[T2_Y0_M8]=ISNULL([T2_Y0_M8],0),
				[T2_Y0_M9]=ISNULL([T2_Y0_M9],0),
				[T2_Y0_M10]=ISNULL([T2_Y0_M10],0),
				[T2_Y0_M11]=ISNULL([T2_Y0_M11],0),
				[T2_Y0_M12]=ISNULL([T2_Y0_M12],0),
				--//---------------------
				[T3_Y0_M1]=ISNULL([T3_Y0_M1],0),
				[T3_Y0_M2]=ISNULL([T3_Y0_M2],0),
				[T3_Y0_M3]=ISNULL([T3_Y0_M3],0),
				[T3_Y0_M4]=ISNULL([T3_Y0_M4],0),
				[T3_Y0_M5]=ISNULL([T3_Y0_M5],0),
				[T3_Y0_M6]=ISNULL([T3_Y0_M6],0),
				[T3_Y0_M7]=ISNULL([T3_Y0_M7],0),
				[T3_Y0_M8]=ISNULL([T3_Y0_M8],0),
				[T3_Y0_M9]=ISNULL([T3_Y0_M9],0),
				[T3_Y0_M10]=ISNULL([T3_Y0_M10],0),
				[T3_Y0_M11]=ISNULL([T3_Y0_M11],0),
				[T3_Y0_M12]=ISNULL([T3_Y0_M12],0)
			from fnc_SubGroupMaster_Full_LLD
			where FM_KEY=(select top 1 FM_KEY from FC_ComputerName (NOLOCK) where [ComputerName]=HOST_NAME())
			--[ComputerName]=HOST_NAME()
		) as x
		WHERE stt = 1
	end
	if @Division='PPD'
	begin
		Insert into @tableTmp
		select
			*
		from
		(
			--//His Y-2
			select DISTINCT
				[STT] = ROW_NUMBER() OVER(PARTITION BY [Division],[Sales Org],[SUB GROUP/ Brand] ORDER BY [Y-2 (u) M1] DESC),
				[Division]=ISNULL([Division],''),
				[FM_KEY]=isnull([FM_KEY],''),
				[Sales Org]=ISNULL([Sales Org],''),
				[SUB GROUP/ Brand]=ISNULL([SUB GROUP/ Brand],''),
				[Y-2 (u) M1]=ISNULL([Y-2 (u) M1],0),
				[Y-2 (u) M2]=ISNULL([Y-2 (u) M2],0),
				[Y-2 (u) M3]=ISNULL([Y-2 (u) M3],0),
				[Y-2 (u) M4]=ISNULL([Y-2 (u) M4],0),
				[Y-2 (u) M5]=ISNULL([Y-2 (u) M5],0),
				[Y-2 (u) M6]=ISNULL([Y-2 (u) M6],0),
				[Y-2 (u) M7]=ISNULL([Y-2 (u) M7],0),
				[Y-2 (u) M8]=ISNULL([Y-2 (u) M8],0),
				[Y-2 (u) M9]=ISNULL([Y-2 (u) M9],0),
				[Y-2 (u) M10]=ISNULL([Y-2 (u) M10],0),
				[Y-2 (u) M11]=ISNULL([Y-2 (u) M11],0),
				[Y-2 (u) M12]=ISNULL([Y-2 (u) M12],0),
				--//His Y-1
				[Y-1 (u) M1]=ISNULL([Y-1 (u) M1],0),
				[Y-1 (u) M2]=ISNULL([Y-1 (u) M2],0),
				[Y-1 (u) M3]=ISNULL([Y-1 (u) M3],0),
				[Y-1 (u) M4]=ISNULL([Y-1 (u) M4],0),
				[Y-1 (u) M5]=ISNULL([Y-1 (u) M5],0),
				[Y-1 (u) M6]=ISNULL([Y-1 (u) M6],0),
				[Y-1 (u) M7]=ISNULL([Y-1 (u) M7],0),
				[Y-1 (u) M8]=ISNULL([Y-1 (u) M8],0),
				[Y-1 (u) M9]=ISNULL([Y-1 (u) M9],0),
				[Y-1 (u) M10]=ISNULL([Y-1 (u) M10],0),
				[Y-1 (u) M11]=ISNULL([Y-1 (u) M11],0),
				[Y-1 (u) M12]=ISNULL([Y-1 (u) M12],0),
				--//forecast Y0
				[Y0 (u) M1]=ISNULL([Y0 (u) M1],0),
				[Y0 (u) M2]=ISNULL([Y0 (u) M2],0),
				[Y0 (u) M3]=ISNULL([Y0 (u) M3],0),
				[Y0 (u) M4]=ISNULL([Y0 (u) M4],0),
				[Y0 (u) M5]=ISNULL([Y0 (u) M5],0),
				[Y0 (u) M6]=ISNULL([Y0 (u) M6],0),
				[Y0 (u) M7]=ISNULL([Y0 (u) M7],0),
				[Y0 (u) M8]=ISNULL([Y0 (u) M8],0),
				[Y0 (u) M9]=ISNULL([Y0 (u) M9],0),
				[Y0 (u) M10]=ISNULL([Y0 (u) M10],0),
				[Y0 (u) M11]=ISNULL([Y0 (u) M11],0),
				[Y0 (u) M12]=ISNULL([Y0 (u) M12],0),
				--//forecast Y+1
				[Y+1 (u) M1]=ISNULL([Y+1 (u) M1],0),
				[Y+1 (u) M2]=ISNULL([Y+1 (u) M2],0),
				[Y+1 (u) M3]=ISNULL([Y+1 (u) M3],0),
				[Y+1 (u) M4]=ISNULL([Y+1 (u) M4],0),
				[Y+1 (u) M5]=ISNULL([Y+1 (u) M5],0),
				[Y+1 (u) M6]=ISNULL([Y+1 (u) M6],0),
				[Y+1 (u) M7]=ISNULL([Y+1 (u) M7],0),
				[Y+1 (u) M8]=ISNULL([Y+1 (u) M8],0),
				[Y+1 (u) M9]=ISNULL([Y+1 (u) M9],0),
				[Y+1 (u) M10]=ISNULL([Y+1 (u) M10],0),
				[Y+1 (u) M11]=ISNULL([Y+1 (u) M11],0),
				[Y+1 (u) M12]=ISNULL([Y+1 (u) M12],0),
				--//budget y0		
				[B_Y0_M1]=ISNULL([B_Y0_M1],0),
				[B_Y0_M2]=ISNULL([B_Y0_M2],0),
				[B_Y0_M3]=ISNULL([B_Y0_M3],0),
				[B_Y0_M4]=ISNULL([B_Y0_M4],0),
				[B_Y0_M5]=ISNULL([B_Y0_M5],0),
				[B_Y0_M6]=ISNULL([B_Y0_M6],0),
				[B_Y0_M7]=ISNULL([B_Y0_M7],0),
				[B_Y0_M8]=ISNULL([B_Y0_M8],0),
				[B_Y0_M9]=ISNULL([B_Y0_M9],0),
				[B_Y0_M10]=ISNULL([B_Y0_M10],0),
				[B_Y0_M11]=ISNULL([B_Y0_M11],0),
				[B_Y0_M12]=ISNULL([B_Y0_M12],0),
				--//budget Y+1
				[B_Y+1_M1]=ISNULL([B_Y+1_M1],0),
				[B_Y+1_M2]=ISNULL([B_Y+1_M2],0),
				[B_Y+1_M3]=ISNULL([B_Y+1_M3],0),
				[B_Y+1_M4]=ISNULL([B_Y+1_M4],0),
				[B_Y+1_M5]=ISNULL([B_Y+1_M5],0),
				[B_Y+1_M6]=ISNULL([B_Y+1_M6],0),
				[B_Y+1_M7]=ISNULL([B_Y+1_M7],0),
				[B_Y+1_M8]=ISNULL([B_Y+1_M8],0),
				[B_Y+1_M9]=ISNULL([B_Y+1_M9],0),
				[B_Y+1_M10]=ISNULL([B_Y+1_M10],0),
				[B_Y+1_M11]=ISNULL([B_Y+1_M11],0),
				[B_Y+1_M12]=ISNULL([B_Y+1_M12],0),
				--//pre budget Y+1
				[PB_Y+1_M1]=ISNULL([PB_Y+1_M1],0),
				[PB_Y+1_M2]=ISNULL([PB_Y+1_M2],0),
				[PB_Y+1_M3]=ISNULL([PB_Y+1_M3],0),
				[PB_Y+1_M4]=ISNULL([PB_Y+1_M4],0),
				[PB_Y+1_M5]=ISNULL([PB_Y+1_M5],0),
				[PB_Y+1_M6]=ISNULL([PB_Y+1_M6],0),
				[PB_Y+1_M7]=ISNULL([PB_Y+1_M7],0),
				[PB_Y+1_M8]=ISNULL([PB_Y+1_M8],0),
				[PB_Y+1_M9]=ISNULL([PB_Y+1_M9],0),
				[PB_Y+1_M10]=ISNULL([PB_Y+1_M10],0),
				[PB_Y+1_M11]=ISNULL([PB_Y+1_M11],0),
				[PB_Y+1_M12]=ISNULL([PB_Y+1_M12],0),
				--//Trend 1 Y0
				[T1_Y0_M1]=ISNULL([T1_Y0_M1],0),
				[T1_Y0_M2]=ISNULL([T1_Y0_M2],0),
				[T1_Y0_M3]=ISNULL([T1_Y0_M3],0),
				[T1_Y0_M4]=ISNULL([T1_Y0_M4],0),
				[T1_Y0_M5]=ISNULL([T1_Y0_M5],0),
				[T1_Y0_M6]=ISNULL([T1_Y0_M6],0),
				[T1_Y0_M7]=ISNULL([T1_Y0_M7],0),
				[T1_Y0_M8]=ISNULL([T1_Y0_M8],0),
				[T1_Y0_M9]=ISNULL([T1_Y0_M9],0),
				[T1_Y0_M10]=ISNULL([T1_Y0_M10],0),
				[T1_Y0_M11]=ISNULL([T1_Y0_M11],0),
				[T1_Y0_M12]=ISNULL([T1_Y0_M12],0),
				--//Trend 2 Y0
				[T2_Y0_M1]=ISNULL([T2_Y0_M1],0),
				[T2_Y0_M2]=ISNULL([T2_Y0_M2],0),
				[T2_Y0_M3]=ISNULL([T2_Y0_M3],0),
				[T2_Y0_M4]=ISNULL([T2_Y0_M4],0),
				[T2_Y0_M5]=ISNULL([T2_Y0_M5],0),
				[T2_Y0_M6]=ISNULL([T2_Y0_M6],0),
				[T2_Y0_M7]=ISNULL([T2_Y0_M7],0),
				[T2_Y0_M8]=ISNULL([T2_Y0_M8],0),
				[T2_Y0_M9]=ISNULL([T2_Y0_M9],0),
				[T2_Y0_M10]=ISNULL([T2_Y0_M10],0),
				[T2_Y0_M11]=ISNULL([T2_Y0_M11],0),
				[T2_Y0_M12]=ISNULL([T2_Y0_M12],0),
				--//---------------------
				[T3_Y0_M1]=ISNULL([T3_Y0_M1],0),
				[T3_Y0_M2]=ISNULL([T3_Y0_M2],0),
				[T3_Y0_M3]=ISNULL([T3_Y0_M3],0),
				[T3_Y0_M4]=ISNULL([T3_Y0_M4],0),
				[T3_Y0_M5]=ISNULL([T3_Y0_M5],0),
				[T3_Y0_M6]=ISNULL([T3_Y0_M6],0),
				[T3_Y0_M7]=ISNULL([T3_Y0_M7],0),
				[T3_Y0_M8]=ISNULL([T3_Y0_M8],0),
				[T3_Y0_M9]=ISNULL([T3_Y0_M9],0),
				[T3_Y0_M10]=ISNULL([T3_Y0_M10],0),
				[T3_Y0_M11]=ISNULL([T3_Y0_M11],0),
				[T3_Y0_M12]=ISNULL([T3_Y0_M12],0)
			from fnc_SubGroupMaster_Full_PPD
			where FM_KEY=(select top 1 FM_KEY from FC_ComputerName (NOLOCK) where [ComputerName]=HOST_NAME())
			--[ComputerName]=HOST_NAME()
		) as x
		WHERE stt = 1
	end
	else if @Division='LDB'
	begin
		Insert into @tableTmp
		select
			*
		from
		(
			--//His Y-2
			select DISTINCT
				[STT] = ROW_NUMBER() OVER(PARTITION BY [Division],[Sales Org],[SUB GROUP/ Brand] ORDER BY [Y-2 (u) M1] DESC),
				[Division]=ISNULL([Division],''),
				[FM_KEY]=isnull([FM_KEY],''),
				[Sales Org]=ISNULL([Sales Org],''),
				[SUB GROUP/ Brand]=ISNULL([SUB GROUP/ Brand],''),
				[Y-2 (u) M1]=ISNULL([Y-2 (u) M1],0),
				[Y-2 (u) M2]=ISNULL([Y-2 (u) M2],0),
				[Y-2 (u) M3]=ISNULL([Y-2 (u) M3],0),
				[Y-2 (u) M4]=ISNULL([Y-2 (u) M4],0),
				[Y-2 (u) M5]=ISNULL([Y-2 (u) M5],0),
				[Y-2 (u) M6]=ISNULL([Y-2 (u) M6],0),
				[Y-2 (u) M7]=ISNULL([Y-2 (u) M7],0),
				[Y-2 (u) M8]=ISNULL([Y-2 (u) M8],0),
				[Y-2 (u) M9]=ISNULL([Y-2 (u) M9],0),
				[Y-2 (u) M10]=ISNULL([Y-2 (u) M10],0),
				[Y-2 (u) M11]=ISNULL([Y-2 (u) M11],0),
				[Y-2 (u) M12]=ISNULL([Y-2 (u) M12],0),
				--//His Y-1
				[Y-1 (u) M1]=ISNULL([Y-1 (u) M1],0),
				[Y-1 (u) M2]=ISNULL([Y-1 (u) M2],0),
				[Y-1 (u) M3]=ISNULL([Y-1 (u) M3],0),
				[Y-1 (u) M4]=ISNULL([Y-1 (u) M4],0),
				[Y-1 (u) M5]=ISNULL([Y-1 (u) M5],0),
				[Y-1 (u) M6]=ISNULL([Y-1 (u) M6],0),
				[Y-1 (u) M7]=ISNULL([Y-1 (u) M7],0),
				[Y-1 (u) M8]=ISNULL([Y-1 (u) M8],0),
				[Y-1 (u) M9]=ISNULL([Y-1 (u) M9],0),
				[Y-1 (u) M10]=ISNULL([Y-1 (u) M10],0),
				[Y-1 (u) M11]=ISNULL([Y-1 (u) M11],0),
				[Y-1 (u) M12]=ISNULL([Y-1 (u) M12],0),
				--//forecast Y0
				[Y0 (u) M1]=ISNULL([Y0 (u) M1],0),
				[Y0 (u) M2]=ISNULL([Y0 (u) M2],0),
				[Y0 (u) M3]=ISNULL([Y0 (u) M3],0),
				[Y0 (u) M4]=ISNULL([Y0 (u) M4],0),
				[Y0 (u) M5]=ISNULL([Y0 (u) M5],0),
				[Y0 (u) M6]=ISNULL([Y0 (u) M6],0),
				[Y0 (u) M7]=ISNULL([Y0 (u) M7],0),
				[Y0 (u) M8]=ISNULL([Y0 (u) M8],0),
				[Y0 (u) M9]=ISNULL([Y0 (u) M9],0),
				[Y0 (u) M10]=ISNULL([Y0 (u) M10],0),
				[Y0 (u) M11]=ISNULL([Y0 (u) M11],0),
				[Y0 (u) M12]=ISNULL([Y0 (u) M12],0),
				--//forecast Y+1
				[Y+1 (u) M1]=ISNULL([Y+1 (u) M1],0),
				[Y+1 (u) M2]=ISNULL([Y+1 (u) M2],0),
				[Y+1 (u) M3]=ISNULL([Y+1 (u) M3],0),
				[Y+1 (u) M4]=ISNULL([Y+1 (u) M4],0),
				[Y+1 (u) M5]=ISNULL([Y+1 (u) M5],0),
				[Y+1 (u) M6]=ISNULL([Y+1 (u) M6],0),
				[Y+1 (u) M7]=ISNULL([Y+1 (u) M7],0),
				[Y+1 (u) M8]=ISNULL([Y+1 (u) M8],0),
				[Y+1 (u) M9]=ISNULL([Y+1 (u) M9],0),
				[Y+1 (u) M10]=ISNULL([Y+1 (u) M10],0),
				[Y+1 (u) M11]=ISNULL([Y+1 (u) M11],0),
				[Y+1 (u) M12]=ISNULL([Y+1 (u) M12],0),
				--//budget y0		
				[B_Y0_M1]=ISNULL([B_Y0_M1],0),
				[B_Y0_M2]=ISNULL([B_Y0_M2],0),
				[B_Y0_M3]=ISNULL([B_Y0_M3],0),
				[B_Y0_M4]=ISNULL([B_Y0_M4],0),
				[B_Y0_M5]=ISNULL([B_Y0_M5],0),
				[B_Y0_M6]=ISNULL([B_Y0_M6],0),
				[B_Y0_M7]=ISNULL([B_Y0_M7],0),
				[B_Y0_M8]=ISNULL([B_Y0_M8],0),
				[B_Y0_M9]=ISNULL([B_Y0_M9],0),
				[B_Y0_M10]=ISNULL([B_Y0_M10],0),
				[B_Y0_M11]=ISNULL([B_Y0_M11],0),
				[B_Y0_M12]=ISNULL([B_Y0_M12],0),
				--//budget Y+1
				[B_Y+1_M1]=ISNULL([B_Y+1_M1],0),
				[B_Y+1_M2]=ISNULL([B_Y+1_M2],0),
				[B_Y+1_M3]=ISNULL([B_Y+1_M3],0),
				[B_Y+1_M4]=ISNULL([B_Y+1_M4],0),
				[B_Y+1_M5]=ISNULL([B_Y+1_M5],0),
				[B_Y+1_M6]=ISNULL([B_Y+1_M6],0),
				[B_Y+1_M7]=ISNULL([B_Y+1_M7],0),
				[B_Y+1_M8]=ISNULL([B_Y+1_M8],0),
				[B_Y+1_M9]=ISNULL([B_Y+1_M9],0),
				[B_Y+1_M10]=ISNULL([B_Y+1_M10],0),
				[B_Y+1_M11]=ISNULL([B_Y+1_M11],0),
				[B_Y+1_M12]=ISNULL([B_Y+1_M12],0),
				--//pre budget Y+1
				[PB_Y+1_M1]=ISNULL([PB_Y+1_M1],0),
				[PB_Y+1_M2]=ISNULL([PB_Y+1_M2],0),
				[PB_Y+1_M3]=ISNULL([PB_Y+1_M3],0),
				[PB_Y+1_M4]=ISNULL([PB_Y+1_M4],0),
				[PB_Y+1_M5]=ISNULL([PB_Y+1_M5],0),
				[PB_Y+1_M6]=ISNULL([PB_Y+1_M6],0),
				[PB_Y+1_M7]=ISNULL([PB_Y+1_M7],0),
				[PB_Y+1_M8]=ISNULL([PB_Y+1_M8],0),
				[PB_Y+1_M9]=ISNULL([PB_Y+1_M9],0),
				[PB_Y+1_M10]=ISNULL([PB_Y+1_M10],0),
				[PB_Y+1_M11]=ISNULL([PB_Y+1_M11],0),
				[PB_Y+1_M12]=ISNULL([PB_Y+1_M12],0),
				--//Trend 1 Y0
				[T1_Y0_M1]=ISNULL([T1_Y0_M1],0),
				[T1_Y0_M2]=ISNULL([T1_Y0_M2],0),
				[T1_Y0_M3]=ISNULL([T1_Y0_M3],0),
				[T1_Y0_M4]=ISNULL([T1_Y0_M4],0),
				[T1_Y0_M5]=ISNULL([T1_Y0_M5],0),
				[T1_Y0_M6]=ISNULL([T1_Y0_M6],0),
				[T1_Y0_M7]=ISNULL([T1_Y0_M7],0),
				[T1_Y0_M8]=ISNULL([T1_Y0_M8],0),
				[T1_Y0_M9]=ISNULL([T1_Y0_M9],0),
				[T1_Y0_M10]=ISNULL([T1_Y0_M10],0),
				[T1_Y0_M11]=ISNULL([T1_Y0_M11],0),
				[T1_Y0_M12]=ISNULL([T1_Y0_M12],0),
				--//Trend 2 Y0
				[T2_Y0_M1]=ISNULL([T2_Y0_M1],0),
				[T2_Y0_M2]=ISNULL([T2_Y0_M2],0),
				[T2_Y0_M3]=ISNULL([T2_Y0_M3],0),
				[T2_Y0_M4]=ISNULL([T2_Y0_M4],0),
				[T2_Y0_M5]=ISNULL([T2_Y0_M5],0),
				[T2_Y0_M6]=ISNULL([T2_Y0_M6],0),
				[T2_Y0_M7]=ISNULL([T2_Y0_M7],0),
				[T2_Y0_M8]=ISNULL([T2_Y0_M8],0),
				[T2_Y0_M9]=ISNULL([T2_Y0_M9],0),
				[T2_Y0_M10]=ISNULL([T2_Y0_M10],0),
				[T2_Y0_M11]=ISNULL([T2_Y0_M11],0),
				[T2_Y0_M12]=ISNULL([T2_Y0_M12],0),
				--//---------------------
				[T3_Y0_M1]=ISNULL([T3_Y0_M1],0),
				[T3_Y0_M2]=ISNULL([T3_Y0_M2],0),
				[T3_Y0_M3]=ISNULL([T3_Y0_M3],0),
				[T3_Y0_M4]=ISNULL([T3_Y0_M4],0),
				[T3_Y0_M5]=ISNULL([T3_Y0_M5],0),
				[T3_Y0_M6]=ISNULL([T3_Y0_M6],0),
				[T3_Y0_M7]=ISNULL([T3_Y0_M7],0),
				[T3_Y0_M8]=ISNULL([T3_Y0_M8],0),
				[T3_Y0_M9]=ISNULL([T3_Y0_M9],0),
				[T3_Y0_M10]=ISNULL([T3_Y0_M10],0),
				[T3_Y0_M11]=ISNULL([T3_Y0_M11],0),
				[T3_Y0_M12]=ISNULL([T3_Y0_M12],0)
			from fnc_SubGroupMaster_Full_LDB
			where FM_KEY=(select top 1 FM_KEY from FC_ComputerName (NOLOCK) where [ComputerName]=HOST_NAME())
			and Barcode NOT IN
			(
				'3337871325572',
				'3337871324681',
				'3337872414084',
				'3433422405318'
			)
		) as x
		WHERE stt = 1
	end
	
	insert into @tablefinal
	select * from @tableTmp

	return
end
