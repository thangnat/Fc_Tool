/*
	select * from fnc_SubGroupMaster_LLD_RSP('full') 
	WHERE [SUB GROUP/ Brand] ='AGE REWIND CONCEALER'
*/
Alter function fnc_SubGroupMaster_LLD_RSP(@Type nvarchar(4))--NO USE
returns TABLE
with encryption
As
	return
	select
		*
	from
	(
		--//His Y-2
		select DISTINCT
			stt = ROW_NUMBER() OVER(PARTITION BY [Division],[Sales Org],[SUB GROUP/ Brand] ORDER BY [Y-2 (u) M1] DESC),
			[Division],
			[Sales Org],
			[SUB GROUP/ Brand],
			--[CAT/Axe],
			--[SUB CAT/ Sub Axe],
			--[GROUP/ Class],
			--[HERO],
			--[Product status],
			--[Signature],
			--[Product Type],
			--Active,
			[Y-2 (u) M1],
			[Y-2 (u) M2],
			[Y-2 (u) M3],
			[Y-2 (u) M4],
			[Y-2 (u) M5],
			[Y-2 (u) M6],
			[Y-2 (u) M7],
			[Y-2 (u) M8],
			[Y-2 (u) M9],
			[Y-2 (u) M10],
			[Y-2 (u) M11],
			[Y-2 (u) M12],
			--//His Y-1
			[Y-1 (u) M1],
			[Y-1 (u) M2],
			[Y-1 (u) M3],
			[Y-1 (u) M4],
			[Y-1 (u) M5],
			[Y-1 (u) M6],
			[Y-1 (u) M7],
			[Y-1 (u) M8],
			[Y-1 (u) M9],
			[Y-1 (u) M10],
			[Y-1 (u) M11],
			[Y-1 (u) M12],
			--//forecast Y0
			[Y0 (u) M1],
			[Y0 (u) M2],
			[Y0 (u) M3],
			[Y0 (u) M4],
			[Y0 (u) M5],
			[Y0 (u) M6],
			[Y0 (u) M7],
			[Y0 (u) M8],
			[Y0 (u) M9],
			[Y0 (u) M10],
			[Y0 (u) M11],
			[Y0 (u) M12],
			--//forecast Y+1
			[Y+1 (u) M1],
			[Y+1 (u) M2],
			[Y+1 (u) M3],
			[Y+1 (u) M4],
			[Y+1 (u) M5],
			[Y+1 (u) M6],
			[Y+1 (u) M7],
			[Y+1 (u) M8],
			[Y+1 (u) M9],
			[Y+1 (u) M10],
			[Y+1 (u) M11],
			[Y+1 (u) M12],
			--//budget y0		
			[B_Y0_M1],
			[B_Y0_M2],
			[B_Y0_M3],
			[B_Y0_M4],
			[B_Y0_M5],
			[B_Y0_M6],
			[B_Y0_M7],
			[B_Y0_M8],
			[B_Y0_M9],
			[B_Y0_M10],
			[B_Y0_M11],
			[B_Y0_M12],
			--//budget Y+1
			[B_Y+1_M1],
			[B_Y+1_M2],
			[B_Y+1_M3],
			[B_Y+1_M4],
			[B_Y+1_M5],
			[B_Y+1_M6],
			[B_Y+1_M7],
			[B_Y+1_M8],
			[B_Y+1_M9],
			[B_Y+1_M10],
			[B_Y+1_M11],
			[B_Y+1_M12],
			--//pre budget Y+1
			[PB_Y+1_M1],
			[PB_Y+1_M2],
			[PB_Y+1_M3],
			[PB_Y+1_M4],
			[PB_Y+1_M5],
			[PB_Y+1_M6],
			[PB_Y+1_M7],
			[PB_Y+1_M8],
			[PB_Y+1_M9],
			[PB_Y+1_M10],
			[PB_Y+1_M11],
			[PB_Y+1_M12],
			--//Trend 1 Y0
			[T3_Y0_M1],
			[T3_Y0_M2],
			[T3_Y0_M3],
			[T3_Y0_M4],
			[T3_Y0_M5],
			[T3_Y0_M6],
			[T3_Y0_M7],
			[T3_Y0_M8],
			[T3_Y0_M9],
			[T3_Y0_M10],
			[T3_Y0_M11],
			[T3_Y0_M12],
			--//Trend 2 Y0
			[T5_Y0_M1],
			[T5_Y0_M2],
			[T5_Y0_M3],
			[T5_Y0_M4],
			[T5_Y0_M5],
			[T5_Y0_M6],
			[T5_Y0_M7],
			[T5_Y0_M8],
			[T5_Y0_M9],
			[T5_Y0_M10],
			[T5_Y0_M11],
			[T5_Y0_M12],
			--//---------------------
			[T7_Y0_M1],
			[T7_Y0_M2],
			[T7_Y0_M3],
			[T7_Y0_M4],
			[T7_Y0_M5],
			[T7_Y0_M6],
			[T7_Y0_M7],
			[T7_Y0_M8],
			[T7_Y0_M9],
			[T7_Y0_M10],
			[T7_Y0_M11],
			[T7_Y0_M12]
		from fnc_SubGroupMaster_LLD(@Type)
	) as x
	WHERE stt = 1
